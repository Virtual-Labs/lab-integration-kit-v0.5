<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
               "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
lang="en" xml:lang="en">
<head>
<title>wapiti-tutorial</title>
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1"/>
<meta name="generator" content="Org-mode"/>
<meta name="generated" content="2014-09-15 23:01:21 IST"/>
<meta name="author" content="Ishan Sharma"/>
<meta name="description" content=""/>
<meta name="keywords" content=""/>
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  html { font-family: Times, serif; font-size: 12pt; }
  .title  { text-align: center; }
  .todo   { color: red; }
  .done   { color: green; }
  .tag    { background-color: #add8e6; font-weight:normal }
  .target { }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  p.verse { margin-left: 3% }
  pre {
	border: 1pt solid #AEBDCC;
	background-color: #F3F5F7;
	padding: 5pt;
	font-family: courier, monospace;
        font-size: 90%;
        overflow:auto;
  }
  table { border-collapse: collapse; }
  td, th { vertical-align: top; }
  dt { font-weight: bold; }
  div.figure { padding: 0.5em; }
  div.figure p { text-align: center; }
  .linenr { font-size:smaller }
  .code-highlighted {background-color:#ffff00;}
  .org-info-js_info-navigation { border-style:none; }
  #org-info-js_console-label { font-size:10px; font-weight:bold;
                               white-space:nowrap; }
  .org-info-js_search-highlight {background-color:#ffff00; color:#000000;
                                 font-weight:bold; }
  /*]]>*/-->
</style>
<script type="text/javascript">
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">

<h1 class="title">wapiti-tutorial</h1>


<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">1 Usage </a></li>
<li><a href="#sec-2">2 Tutorial </a></li>
</ul>
</div>
</div>

<div id="outline-container-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> Usage </h2>
<div class="outline-text-2" id="text-1">

<ul>
<li>
Usage Syntax: python wapiti.py <a href="http://server.com/base/url/">http://server.com/base/url/</a> [options] 


</li>
</ul>


<pre class="example">+ Supported options are: 
 -  -s &lt;url&gt; 
 -  --start &lt;url&gt; 
   + To specify an url to start with. This option can be called several times.
   + Wapiti will browse these links to find more URLs even if the specified link is not in the scope.
 
 -  -x &lt;url&gt; 
 -  --exclude &lt;url&gt; 
   + To exclude an URL from the scan (eg: logout URLs). This option can be called several times to specify several URLs.
   + Wildcards (*) can be used in URLs for basic regex.
   + Example : -x http://server/base/?page=*&amp;module=test or -x http://server/base/admin/* to exclude a directory.
 
 -  -p &lt;url_proxy&gt; 
 -  --proxy &lt;url_proxy&gt; 
   + To specify a proxy. Currently supported proxies are HTTP and HTTPS.
   + This option can be called twice to specify the HTTP and the HTTPS proxy.
   + Example: -p http://proxy:port/
 
 -  -c &lt;cookie_file&gt; 
 -  --cookie &lt;cookie_file&gt; 
   + To import cookies to use for the scan. The cookie file must be in JSON format.
   + Cookies can be grabbed using the cookie.py and getcookie.py utilities (net directory).
 
 -  -t &lt;timeout&gt; 
 -  --timeout &lt;timeout&gt; 
   + To set the timeout (maximum time in seconds to wait for the server to send a response).
 
 -  -a &lt;login%password&gt; 
 -  --auth &lt;login%password&gt; 
   + Set credentials for HTTP authentication.
 
 -  --auth-method &lt;method&gt;
   + If the server requires an authentication, set the authentication method to use.
   + Currently supported methods are (some requires additional modules to install):
        -  basic
        -  digest
        -  kerberos
        -  ntlm
 
 -  -r &lt;parameter_name&gt; 
 -  --remove &lt;parameter_name&gt; 
   + Remove a parameter (name and value) from URLs.
 
 -  -n &lt;limit&gt; 
 -  --nice &lt;limit&gt; 
   + Define a limit of URLs to browse with the same pattern (ie, the maximum number of unique values for the same parameter).
   + Use this option to prevent endless loops during scan. Limit must be greater than 0.
 
 -  -m &lt;module_options&gt;
 -  --module &lt;module_options&gt;
   + Set the modules (and HTTP methods for each module) to use for attacks.
   + Prefix a module name with a dash to deactivate the related module.
   + To only browse the target (without sending any payloads), deactivate every module with -m "-all".
   + If you don't specify the HTTP methods, GET and POST will be used.
     - Example: -m "-all,xss:get,exec:post"
 
 -  -u 
 -  --color 
   + Use colors to highlight vulnerabilities and anomalies in output. 
 
 -  -v &lt;level&gt; 
 -  --verbose &lt;level&gt; 
   + Set the verbosity level. 
   + 0: quiet (default), 1: print each URL, 2: print every attack. 
 
 -  -b &lt;scope&gt;
 -  --scope &lt;scope&gt;
   + Set the scope of the scan:
     - page: to analyse only the page given as the root URL.
     - folder: to analyse all the URLs under the root URL passed to Wapiti (default).
     -  domain: to analyse all the links to the pages which are in the same domain as the URL passed to Wapiti.
 
 -  -f &lt;type_file&gt; 
 -  --format &lt;type_file&gt; 
   + Set the format type for the report. 
     - json: Report in JSON format 
     - html: Report in HTML format (default)
     - openvas: Report in OpenVAS XML format 
     - txt: Report in plain text (UTF-8) 
     - vulneranet: Report in VulneraNET (XML based) format 
     - xml: Report in XML format 
 
 -  -o &lt;output&gt; 
 -  --output &lt;output_file&gt; 
   + Set the name of the report file. 
     - If the selected report format is 'html', this parameter will be used as a directory name.
 
 -  -i &lt;file&gt;
 -  --continue &lt;file&gt;
   + This parameter indicates to Wapiti to resume the previous scan saved in the specified XML status file.
    - The file name is optional, if not specified, Wapiti takes the default file from the "scans" folder.
 
 -  -k &lt;file&gt;
 -  --attack &lt;file&gt;
   + This parameter indicates to Wapiti to resume the attacks without scanning the website again, loading the scan status from the specified file.
    - The file name is optional, if it is not specified, Wapiti takes the default file from the "scans" folder.
 
 -  --verify-ssl &lt;0|1&gt;
   + This parameter indicates whether Wapiti must check SSL certificates.
    - Default is to verify certificates
 
 -  -h 
 -  --help 
   + To print this usage message
</pre>




</div>

</div>

<div id="outline-container-2" class="outline-2">
<h2 id="sec-2"><span class="section-number-2">2</span> Tutorial </h2>
<div class="outline-text-2" id="text-2">

<ul>
<li>
Change directory to wapiti-2.3.0 folder.

</li>
<li>
If the web application requires authentication then we need to use <b>wapiti-getcookie</b> to login in the restricted area and get the cookie in cookies.json

</li>
</ul>


<pre class="example">python bin/wapiti-cookie /tmp/cookies.json &lt;domain-name&gt;/login.php 
</pre>




<ul>
<li>
Enter your username and password

</li>
<li>
Then we can use the cookie to scan the protected web pages. We need to exclude the <i>logout</i> page using the <b>-x</b> option

</li>
</ul>


<pre class="example">python bin/wapiti &lt;domain-name&gt; -c /tmp/cookies.json -x &lt;domain-name&gt;/logout.php
</pre>




<ul>
<li>
Reports are generated in HTML by default. We can specify other formats too (Check the <b>-f</b> option) but HTML format is preferred. If HTML output format is selected then we can specify the output directory using the <b>-o</b> option. It is better to set the verbosity level to 2 using the <b>-v</b> option.

</li>
</ul>


<pre class="example">python bin/wapiti &lt;domain-name&gt; -c /tmp/cookies.json - v 2 -o ~/report -x &lt;domain-name&gt;/logout.php
</pre>



</div>
</div>
<div id="postamble">
<p class="author"> Author: Ishan Sharma
<a href="mailto:ishan@Ishan-Vaio">&lt;ishan@Ishan-Vaio&gt;</a>
</p>
<p class="date"> Date: 2014-09-15 23:01:21 IST</p>
<p class="creator">HTML generated by org-mode 6.33x in emacs 23</p>
</div>
</div>
</body>
</html>
